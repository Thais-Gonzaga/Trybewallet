"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=_interopRequireWildcard(require("react")),_reactRedux=require("react-redux"),_constants=require("../../utils/constants"),_backDoorAction=_interopRequireDefault(require("../mockRedux/backDoorAction"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(_getRequireWildcardCache=function(e){return e?a:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var a=_getRequireWildcardCache(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in e)if("default"!==c&&Object.prototype.hasOwnProperty.call(e,c)){var o=r?Object.getOwnPropertyDescriptor(e,c):null;o&&(o.get||o.set)?Object.defineProperty(n,c,o):n[c]=e[c]}return n.default=e,a&&a.set(e,n),n}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const INITIAL_STATE={id:0,value:"",description:"",currency:"USD",method:"Dinheiro",tag:"Alimentação"};class WalletFormSave extends _react.Component{constructor(...e){super(...e),_defineProperty(this,"state",INITIAL_STATE),_defineProperty(this,"fetchCurrencies",()=>fetch("https://economia.awesomeapi.com.br/json/all").then(e=>e.json())),_defineProperty(this,"handleSubmit",async e=>{e.preventDefault();const{dispatch:t,expenses:a,shouldDispatchNewExpense:n,shouldClearInputs:r,shouldIncrementId:c}=this.props,{id:o}=this.state,s=await this.fetchCurrencies();n&&t((0,_backDoorAction.default)({wallet:{expenses:[...a,{...this.state,exchangeRates:s}]}}));const i={...r?INITIAL_STATE:{},id:o+c};this.setState(i)}),_defineProperty(this,"handleChange",e=>{const{name:t,value:a}=e.target;this.setState({[t]:a})})}componentDidMount(){const{dispatch:e}=this.props;this.fetchCurrencies().then(t=>{const{USDT:a,...n}=t;e((0,_backDoorAction.default)({wallet:{currencies:Object.keys(n)}}))})}render(){const{currencies:e,renderSubmitBtn:t}=this.props,{value:a,description:n,currency:r,method:c,tag:o}=this.state;return _react.default.createElement("form",{onSubmit:this.handleSubmit},_react.default.createElement("input",{type:"text",name:"value",value:a,onChange:this.handleChange,"data-testid":_constants.VALUE_INPUT_TEST_ID}),_react.default.createElement("input",{type:"text",name:"description",value:n,onChange:this.handleChange,"data-testid":_constants.DESCRIPTION_INPUT_TEST_ID}),_react.default.createElement("label",{htmlFor:"currency"},"Moeda",_react.default.createElement("select",{name:"currency",id:"currency",value:r,onChange:this.handleChange,"data-testid":_constants.CURRENCY_INPUT_TEST_ID},e.map(e=>_react.default.createElement("option",{key:e,value:e},e)))),_react.default.createElement("label",{htmlFor:"method"},_react.default.createElement("select",{name:"method",id:"method",value:c,onChange:this.handleChange,"data-testid":_constants.METHOD_INPUT_TEST_ID},_constants.methodOptions.map(e=>_react.default.createElement("option",{key:e,value:e},e)))),_react.default.createElement("label",{htmlFor:"tag"},_react.default.createElement("select",{name:"tag",id:"tag",value:o,onChange:this.handleChange,"data-testid":_constants.TAG_INPUT_TEST_ID},_constants.tagOptions.map(e=>_react.default.createElement("option",{key:e,value:e},e)))),t&&_react.default.createElement("button",{type:"submit"},"Adicionar despesa"))}}const mapStateToProps=e=>({currencies:e.wallet.currencies,expenses:e.wallet.expenses});var _default=(0,_reactRedux.connect)(mapStateToProps)(WalletFormSave);exports.default=_default;
